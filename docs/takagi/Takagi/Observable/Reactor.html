<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Takagi::Observable::Reactor
  
    &mdash; Documentation by YARD 0.9.38
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Takagi::Observable::Reactor";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (R)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Observable.html" title="Takagi::Observable (module)">Observable</a></span></span>
     &raquo; 
    <span class="title">Reactor</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Takagi::Observable::Reactor
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Takagi::Observable::Reactor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/takagi/observable/reactor.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Coordinator for observables (resources others watch) and observers (resources we watch)</p>

<p>Supports both interval-based polling and event-driven push notifications. Uses thread pools for parallel execution and resource control.</p>

<p>Similar to Controllers, provides a declarative configuration API for better DX.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Inline in controller</p>
</div></h5>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>SensorController</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Controller.html" title="Takagi::Controller (class)">Controller</a></span></span>
  <span class='id identifier rubyid_reactor'>reactor</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_observable'>observable</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/temp</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_emitter'>emitter</span><span class='op'>|</span>
      <span class='id identifier rubyid_emitter'>emitter</span><span class='period'>.</span><span class='id identifier rubyid_on_event'>on_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sensor.temp.changed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Standalone reactor file (declarative)</p>
</div></h5>
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>IotReactor</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observable.html" title="Takagi::Observable (module)">Observable</a></span></span><span class='op'>::</span><span class='const'>Reactor</span>
  <span class='id identifier rubyid_configure'>configure</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_threads'>threads</span> <span class='int'>8</span>
    <span class='id identifier rubyid_name'>name</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>iot-reactor</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_interval'>interval</span> <span class='float'>0.5</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_observable'>observable</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/sensors/temp</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_emitter'>emitter</span><span class='op'>|</span>
    <span class='id identifier rubyid_emitter'>emitter</span><span class='period'>.</span><span class='id identifier rubyid_on_event'>on_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sensor.temp.changed</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_observe'>observe</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>coap://gateway:5683/commands</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
    <span class='id identifier rubyid_handle_command'>handle_command</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_handle_command'>handle_command</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
    <span class='comment'># Your logic here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
    
  </div>


</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Reactor/ConfigContext.html" title="Takagi::Observable::Reactor::ConfigContext (class)">ConfigContext</a></span>
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#config-instance_method" title="#config (instance method)">#<strong>config</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute config.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#observables-instance_method" title="#observables (instance method)">#<strong>observables</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute observables.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#observers-instance_method" title="#observers (instance method)">#<strong>observers</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute observers.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#thread_pool-instance_method" title="#thread_pool (instance method)">#<strong>thread_pool</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute thread_pool.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#config-class_method" title="config (class method)">.<strong>config</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get or create the reactor’s configuration.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#configure-class_method" title="configure (class method)">.<strong>configure</strong> { ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Configure the reactor (class-level DSL).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inherit_from-class_method" title="inherit_from (class method)">.<strong>inherit_from</strong>(controller_class)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Inherit settings from a controller.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observable-class_method" title="observable (class method)">.<strong>observable</strong>(path) { ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define an observable at class level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observable_polling-class_method" title="observable_polling (class method)">.<strong>observable_polling</strong>(path, interval: nil) { ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define a polling observable at class level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observables-class_method" title="observables (class method)">.<strong>observables</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get class-level observables.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observe-class_method" title="observe (class method)">.<strong>observe</strong>(uri) { ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define a remote observation at class level.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observers-class_method" title="observers (class method)">.<strong>observers</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Get class-level observers.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(threads: nil, name: nil, interval: nil)  &#x21d2; Reactor </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Reactor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#notify-instance_method" title="#notify (instance method)">#<strong>notify</strong>(path, value)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Manually trigger a notification for an observable.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observable-instance_method" title="#observable (instance method)">#<strong>observable</strong>(path) {|emitter| ... } &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define an event-driven observable (push-based).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observable_polling-instance_method" title="#observable_polling (instance method)">#<strong>observable_polling</strong>(path, interval: ) { ... } &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Define a polling observable (interval-based).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#observe-instance_method" title="#observe (instance method)">#<strong>observe</strong>(uri) {|payload, inbound| ... } &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Observe a remote resource.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#running%3F-instance_method" title="#running? (instance method)">#<strong>running?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if reactor is running.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shared_pool%3F-instance_method" title="#shared_pool? (instance method)">#<strong>shared_pool?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if reactor is sharing a thread pool with its controller.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start the reactor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop-instance_method" title="#stop (instance method)">#<strong>stop</strong>  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Stop the reactor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#trigger_observe-instance_method" title="#trigger_observe (instance method)">#<strong>trigger_observe</strong>(uri, value)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Trigger an observe notification manually.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(threads: nil, name: nil, interval: nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Takagi::Observable::Reactor (class)">Reactor</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Reactor.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='label'>threads:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>interval:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Auto-detect controller by naming convention
</span>  <span class='id identifier rubyid_auto_inherit_from_controller'>auto_inherit_from_controller</span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span><span class='lbracket'>[</span><span class='symbol'>:from_controller</span><span class='rbracket'>]</span>

  <span class='comment'># Merge class config with instance overrides
</span>  <span class='id identifier rubyid_class_config'>class_config</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_config'>config</span>
  <span class='id identifier rubyid_controller'>controller</span> <span class='op'>=</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:from_controller</span><span class='rbracket'>]</span>

  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Initializing reactor: </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Associated controller: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_controller'>controller</span><span class='op'>&amp;.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>none</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Explicit threads param: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_threads'>threads</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Class config threads: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Determine if we should share controller&#39;s thread pool
</span>  <span class='comment'># Share if: controller exists AND no explicit thread configuration
</span>  <span class='id identifier rubyid_should_share_pool'>should_share_pool</span> <span class='op'>=</span> <span class='id identifier rubyid_controller'>controller</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_threads'>threads</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_should_share_pool'>should_share_pool</span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Decision: Share thread pool with controller</span><span class='tstring_end'>&quot;</span></span>

    <span class='comment'># Share controller&#39;s thread pool (lazy initialization)
</span>    <span class='ivar'>@thread_pool</span> <span class='op'>=</span> <span class='id identifier rubyid_controller'>controller</span><span class='period'>.</span><span class='id identifier rubyid_thread_pool'>thread_pool</span>
    <span class='ivar'>@shared_pool</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='ivar'>@config</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>threads:</span> <span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span>
      <span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_default_reactor_name'>default_reactor_name</span><span class='comma'>,</span>
      <span class='label'>interval:</span> <span class='id identifier rubyid_interval'>interval</span> <span class='op'>||</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:interval</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='float'>1.0</span>
    <span class='rbrace'>}</span>

    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reactor &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; sharing thread pool with </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_controller'>controller</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> (</span><span class='embexpr_beg'>#{</span><span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> threads)</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Shared pool object_id: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Decision: Create independent thread pool</span><span class='tstring_end'>&quot;</span></span>

    <span class='comment'># Create independent thread pool
</span>    <span class='ivar'>@shared_pool</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='ivar'>@config</span> <span class='op'>=</span> <span class='lbrace'>{</span>
      <span class='label'>threads:</span> <span class='id identifier rubyid_threads'>threads</span> <span class='op'>||</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>1</span><span class='comma'>,</span>
      <span class='label'>name:</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_default_reactor_name'>default_reactor_name</span><span class='comma'>,</span>
      <span class='label'>interval:</span> <span class='id identifier rubyid_interval'>interval</span> <span class='op'>||</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:interval</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='float'>1.0</span>
    <span class='rbrace'>}</span>

    <span class='ivar'>@thread_pool</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Controller.html" title="Takagi::Controller (class)">Controller</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Controller/ThreadPool.html" title="Takagi::Controller::ThreadPool (class)">ThreadPool</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Controller/ThreadPool.html#initialize-instance_method" title="Takagi::Controller::ThreadPool#initialize (method)">new</a></span></span><span class='lparen'>(</span>
      <span class='label'>size:</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>name:</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
    <span class='rparen'>)</span>

    <span class='id identifier rubyid_reason'>reason</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_controller'>controller</span>
               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no associated controller</span><span class='tstring_end'>&quot;</span></span>
             <span class='kw'>elsif</span> <span class='id identifier rubyid_threads'>threads</span>
               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>explicit threads parameter (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_threads'>threads</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
             <span class='kw'>elsif</span> <span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span>
               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>explicit class configuration (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_class_config'>class_config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> threads)</span><span class='tstring_end'>&quot;</span></span>
             <span class='kw'>else</span>
               <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown reason</span><span class='tstring_end'>&quot;</span></span>
             <span class='kw'>end</span>

    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reactor &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; created independent thread pool (</span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> threads) - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_reason'>reason</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Independent pool object_id: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_object_id'>object_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@observables</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@observers</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@watcher</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Observer.html" title="Takagi::Observer (module)">Observer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observer/Watcher.html" title="Takagi::Observer::Watcher (class)">Watcher</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Observer/Watcher.html#initialize-instance_method" title="Takagi::Observer::Watcher#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>interval:</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:interval</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reactor initialization complete: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='comment'># Register class-level observables and observers
</span>  <span class='id identifier rubyid_setup_class_definitions'>setup_class_definitions</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="config-instance_method">
  
    #<strong>config</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute config.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_config'>config</span>
  <span class='ivar'>@config</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="observables-instance_method">
  
    #<strong>observables</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute observables.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observables'>observables</span>
  <span class='ivar'>@observables</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="observers-instance_method">
  
    #<strong>observers</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute observers.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observers'>observers</span>
  <span class='ivar'>@observers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="thread_pool-instance_method">
  
    #<strong>thread_pool</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute thread_pool.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_thread_pool'>thread_pool</span>
  <span class='ivar'>@thread_pool</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="config-class_method">
  
    .<strong>config</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get or create the reactor’s configuration</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The reactor’s configuration hash</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_config'>config</span>
  <span class='ivar'>@config</span> <span class='op'>||=</span> <span class='lbrace'>{</span>
    <span class='label'>threads:</span> <span class='kw'>nil</span><span class='comma'>,</span>  <span class='comment'># Will be set to 1 if no controller found
</span>    <span class='label'>name:</span> <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='label'>interval:</span> <span class='float'>1.0</span><span class='comma'>,</span>
    <span class='label'>from_controller:</span> <span class='kw'>nil</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="configure-class_method">
  
    .<strong>configure</strong> { ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Configure the reactor (class-level DSL)</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_configure'>configure</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_threads'>threads</span> <span class='int'>8</span>
  <span class='id identifier rubyid_name'>name</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>iot-reactor</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_interval'>interval</span> <span class='float'>0.5</span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Block for configuration DSL</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 69</span>

<span class='kw'>def</span> <span class='id identifier rubyid_configure'>configure</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Reactor/ConfigContext.html" title="Takagi::Observable::Reactor::ConfigContext (class)">ConfigContext</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Reactor/ConfigContext.html#initialize-instance_method" title="Takagi::Observable::Reactor::ConfigContext#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_instance_eval'>instance_eval</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inherit_from-class_method">
  
    .<strong>inherit_from</strong>(controller_class)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Inherit settings from a controller</p>

<p>Associates this reactor with a controller for thread pool sharing. Does NOT set threads in config to allow automatic pool sharing.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='kw'>class</span> <span class='const'>TelemetryReactor</span> <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observable.html" title="Takagi::Observable (module)">Observable</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="" title="Takagi::Observable::Reactor (class)">Reactor</a></span></span>
  <span class='id identifier rubyid_inherit_from'>inherit_from</span> <span class='const'>TelemetryController</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>controller_class</span>
      
      
        <span class='type'>(<tt>Class</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Controller class to inherit from</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 84</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inherit_from'>inherit_from</span><span class='lparen'>(</span><span class='id identifier rubyid_controller_class'>controller_class</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_config'>config</span><span class='lbracket'>[</span><span class='symbol'>:from_controller</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_controller_class'>controller_class</span>
  <span class='comment'># Only set name, NOT threads (to allow pool sharing)
</span>  <span class='id identifier rubyid_config'>config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_controller_class'>controller_class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>::</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>controller</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>-reactor</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observable-class_method">
  
    .<strong>observable</strong>(path) { ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define an observable at class level</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The resource path</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Block for observable definition</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observable'>observable</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_observables'>observables</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>type:</span> <span class='symbol'>:event_driven</span><span class='comma'>,</span> <span class='label'>block:</span> <span class='id identifier rubyid_block'>block</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observable_polling-class_method">
  
    .<strong>observable_polling</strong>(path, interval: nil) { ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define a polling observable at class level</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The resource path</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>interval</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Polling interval</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Block for observable definition</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observable_polling'>observable_polling</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>interval:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_observables'>observables</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>type:</span> <span class='symbol'>:polling</span><span class='comma'>,</span> <span class='label'>interval:</span> <span class='id identifier rubyid_interval'>interval</span><span class='comma'>,</span> <span class='label'>block:</span> <span class='id identifier rubyid_block'>block</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observables-class_method">
  
    .<strong>observables</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get class-level observables</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 116</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observables'>observables</span>
  <span class='ivar'>@observables</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observe-class_method">
  
    .<strong>observe</strong>(uri) { ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Define a remote observation at class level</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Remote CoAP URI</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Block for handling notifications</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observe'>observe</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_observers'>observers</span><span class='lbracket'>[</span><span class='id identifier rubyid_uri'>uri</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observers-class_method">
  
    .<strong>observers</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Get class-level observers</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 121</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observers'>observers</span>
  <span class='ivar'>@observers</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="notify-instance_method">
  
    #<strong>notify</strong>(path, value)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Manually trigger a notification for an observable</p>

<p>Useful for triggering updates from request handlers or other code.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>In a controller action</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_post'>post</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/data</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_process_data'>process_data</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reactor'>reactor</span><span class='period'>.</span><span class='id identifier rubyid_notify'>notify</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/summary</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_calculate_summary'>calculate_summary</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The observable path</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The value to send</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


348
349
350
351
352</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 348</span>

<span class='kw'>def</span> <span class='id identifier rubyid_notify'>notify</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_schedule'>schedule</span> <span class='kw'>do</span>
    <span class='const'><span class='object_link'><a href="../Observer.html" title="Takagi::Observer (module)">Observer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observer/Registry.html" title="Takagi::Observer::Registry (class)">Registry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_notify'><span class='object_link'><a href="../Observer/Registry.html#notify-class_method" title="Takagi::Observer::Registry.notify (method)">notify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observable-instance_method">
  
    #<strong>observable</strong>(path) {|emitter| ... } &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Define an event-driven observable (push-based)</p>

<p>The block receives an emitter that can push updates immediately when data changes, without relying on polling.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>EventBus-driven</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_observable'>observable</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/alerts</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_emitter'>emitter</span><span class='op'>|</span>
  <span class='id identifier rubyid_emitter'>emitter</span><span class='period'>.</span><span class='id identifier rubyid_on_event'>on_event</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>alert.critical</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Custom events</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_observable'>observable</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/temp</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_emitter'>emitter</span><span class='op'>|</span>
  <span class='const'>TempSensor</span><span class='period'>.</span><span class='id identifier rubyid_on_change'>on_change</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span> <span class='id identifier rubyid_emitter'>emitter</span><span class='period'>.</span><span class='id identifier rubyid_notify'>notify</span><span class='lparen'>(</span><span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The resource path</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>emitter</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Block that sets up event listeners</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 283</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observable'>observable</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_emitter'>emitter</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Emitter.html" title="Takagi::Observable::Emitter (class)">Emitter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Emitter.html#initialize-instance_method" title="Takagi::Observable::Emitter#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='ivar'>@observables</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>type:</span> <span class='symbol'>:event_driven</span><span class='comma'>,</span>
    <span class='label'>emitter:</span> <span class='id identifier rubyid_emitter'>emitter</span><span class='comma'>,</span>
    <span class='label'>block:</span> <span class='id identifier rubyid_block'>block</span>
  <span class='rbrace'>}</span>

  <span class='comment'># Register with router so it can be requested
</span>  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Base.html" title="Takagi::Base (class)">Base</a></span></span><span class='period'>.</span><span class='id identifier rubyid_router'><span class='object_link'><a href="../Base.html#router-class_method" title="Takagi::Base.router (method)">router</a></span></span><span class='period'>.</span><span class='id identifier rubyid_observable'><span class='object_link'><a href="../Router.html#observable-instance_method" title="Takagi::Router#observable (method)">observable</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

  <span class='comment'># Initialize the observable in thread pool
</span>  <span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_schedule'>schedule</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_emitter'>emitter</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Event-driven observable registered: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observable_polling-instance_method">
  
    #<strong>observable_polling</strong>(path, interval: ) { ... } &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Define a polling observable (interval-based)</p>

<p>The block is called periodically at the specified interval. Use this for checking remote resources or when event-driven isn’t possible.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Polling remote resource</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_observable_polling'>observable_polling</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/external/status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>interval:</span> <span class='float'>5.0</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_check_external_api'>check_external_api</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The resource path</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>interval</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
        <em class="default">(defaults to: <tt></tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Seconds between polls (default: reactor’s interval)</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>Block that returns the current value</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 316</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observable_polling'>observable_polling</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='label'>interval:</span> <span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:interval</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@observables</span><span class='lbracket'>[</span><span class='id identifier rubyid_path'>path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>type:</span> <span class='symbol'>:polling</span><span class='comma'>,</span>
    <span class='label'>interval:</span> <span class='id identifier rubyid_interval'>interval</span><span class='comma'>,</span>
    <span class='label'>block:</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span>
    <span class='label'>last_run:</span> <span class='kw'>nil</span>
  <span class='rbrace'>}</span>

  <span class='comment'># Register with router
</span>  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Base.html" title="Takagi::Base (class)">Base</a></span></span><span class='period'>.</span><span class='id identifier rubyid_router'><span class='object_link'><a href="../Base.html#router-class_method" title="Takagi::Base.router (method)">router</a></span></span><span class='period'>.</span><span class='id identifier rubyid_observable'><span class='object_link'><a href="../Router.html#observable-instance_method" title="Takagi::Router#observable (method)">observable</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

  <span class='comment'># Start polling loop in thread pool
</span>  <span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_schedule'>schedule</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_poll_observable'>poll_observable</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_interval'>interval</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Polling observable registered: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> (interval: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_interval'>interval</span><span class='embexpr_end'>}</span><span class='tstring_content'>s)</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="observe-instance_method">
  
    #<strong>observe</strong>(uri) {|payload, inbound| ... } &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Observe a remote resource</p>

<p>Subscribe to changes on a remote CoAP server.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_observe'>observe</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>coap://sensor:5683/temp</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
  <span class='id identifier rubyid_process_temperature'>process_temperature</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>CoAP URI to observe</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>payload</tt>, <tt>inbound</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Block called when notification received</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 366</span>

<span class='kw'>def</span> <span class='id identifier rubyid_observe'>observe</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Observing remote resource: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@observers</span><span class='lbracket'>[</span><span class='id identifier rubyid_uri'>uri</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>uri:</span> <span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='label'>handler:</span> <span class='id identifier rubyid_block'>block</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_parsed'>parsed</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed'>parsed</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>

  <span class='comment'># Register local subscription
</span>  <span class='const'><span class='object_link'><a href="../Observer.html" title="Takagi::Observer (module)">Observer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observer/Registry.html" title="Takagi::Observer::Registry (class)">Registry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_subscribe'><span class='object_link'><a href="../Observer/Registry.html#subscribe-class_method" title="Takagi::Observer::Registry.subscribe (method)">subscribe</a></span></span><span class='lparen'>(</span>
    <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span>
    <span class='label'>address:</span> <span class='id identifier rubyid_parsed'>parsed</span><span class='period'>.</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span>
    <span class='label'>port:</span> <span class='id identifier rubyid_parsed'>parsed</span><span class='period'>.</span><span class='id identifier rubyid_port'>port</span> <span class='op'>||</span> <span class='int'>5683</span><span class='comma'>,</span>
    <span class='label'>token:</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_hex'>hex</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>handler:</span> <span class='id identifier rubyid_block'>block</span>
  <span class='rparen'>)</span>

  <span class='comment'># Start observation in thread pool
</span>  <span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_schedule'>schedule</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_client'>client</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Observer.html" title="Takagi::Observer (module)">Observer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observer/Client.html" title="Takagi::Observer::Client (class)">Client</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Observer/Client.html#initialize-instance_method" title="Takagi::Observer::Client#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_on_notify'>on_notify</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_client'>client</span><span class='period'>.</span><span class='id identifier rubyid_subscribe'>subscribe</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="running?-instance_method">
  
    #<strong>running?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if reactor is running</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


447
448
449</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 447</span>

<span class='kw'>def</span> <span class='id identifier rubyid_running?'>running?</span>
  <span class='ivar'>@running</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="shared_pool?-instance_method">
  
    #<strong>shared_pool?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if reactor is sharing a thread pool with its controller</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


454
455
456</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 454</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shared_pool?'>shared_pool?</span>
  <span class='ivar'>@shared_pool</span> <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    #<strong>start</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Start the reactor</p>

<p>Starts the thread pool and any background watchers.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


406
407
408
409
410
411
412
413
414
415
416</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 406</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@running</span>

  <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='ivar'>@watcher</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span> <span class='kw'>if</span> <span class='id identifier rubyid_has_polling_observables?'>has_polling_observables?</span>

  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reactor &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; started with </span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:threads</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> threads</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Event-driven observables: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_event_driven_count'>event_driven_count</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Polling observables: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_polling_count'>polling_count</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Remote observers: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@observers</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop-instance_method">
  
    #<strong>stop</strong>  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Stop the reactor</p>

<p>Gracefully shuts down the thread pool and watchers. Only shuts down thread pool if we own it (not shared).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 424</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop'>stop</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='ivar'>@running</span>

  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Stopping reactor: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Shared pool: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@shared_pool</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

  <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@watcher</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span> <span class='kw'>if</span> <span class='ivar'>@watcher</span>

  <span class='comment'># Only shutdown thread pool if we own it (not shared)
</span>  <span class='kw'>if</span> <span class='ivar'>@shared_pool</span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Skipping thread pool shutdown (shared with controller)</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reactor &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; stopped (thread pool remains active for controller)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  Shutting down independent thread pool</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@thread_pool</span><span class='period'>.</span><span class='id identifier rubyid_shutdown'>shutdown</span>
    <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Reactor &#39;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@config</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; stopped (thread pool shutdown)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="trigger_observe-instance_method">
  
    #<strong>trigger_observe</strong>(uri, value)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Trigger an observe notification manually</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The URI to trigger</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The value</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


395
396
397
398
399</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/takagi/observable/reactor.rb', line 395</span>

<span class='kw'>def</span> <span class='id identifier rubyid_trigger_observe'>trigger_observe</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
  <span class='const'><span class='object_link'><a href="../../Takagi.html" title="Takagi (module)">Takagi</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../../Takagi.html#logger-class_method" title="Takagi.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Trigger observe for path: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_path'>path</span><span class='embexpr_end'>}</span><span class='tstring_content'> with value: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../Observer.html" title="Takagi::Observer (module)">Observer</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Observer/Registry.html" title="Takagi::Observer::Registry (class)">Registry</a></span></span><span class='period'>.</span><span class='id identifier rubyid_notify'><span class='object_link'><a href="../Observer/Registry.html#notify-class_method" title="Takagi::Observer::Registry.notify (method)">notify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Dec 12 09:55:57 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.38 (ruby-3.1.3).
</div>

    </div>
  </body>
</html>